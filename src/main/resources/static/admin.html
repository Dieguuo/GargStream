<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Administraci√≥n - GargStream</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/admin.css">
</head>
<body>

<div class="sidebar">
    <h2>‚öôÔ∏è Admin Panel</h2>

    <button class="menu-btn active" onclick="mostrar('sec-dashboard'); cargarMetricas()">üìä Resumen</button>
    <button class="menu-btn" onclick="mostrar('sec-cine')">üé¨ Nueva Pel√≠cula</button>
    <button class="menu-btn" onclick="mostrar('sec-serie')">üì∫ Nueva Serie</button>
    <button class="menu-btn" onclick="mostrar('sec-capitulo'); cargarSeriesEnSelector()">‚ñ∂Ô∏è Nuevo Cap√≠tulo</button>
    <button class="menu-btn" onclick="mostrar('sec-video')">üìπ Video Personal</button>
    <button class="menu-btn" onclick="mostrar('sec-editar'); cargarContenidoParaEditar()">‚úèÔ∏è Editar / Gestionar</button>

    <a href="index.html" class="back-link">‚Üê Volver al Cat√°logo</a>
</div>

<div class="content">

    <div id="console-box">
        <div class="console-title">Estado del Servidor:</div>
        <div id="console-content">Esperando acci√≥n...</div>
    </div>

    <div id="sec-dashboard" class="form-section active" style="max-width: 100%;">
        <h1>Estado del Servidor</h1>
        <div class="dash-grid">
            <div class="dash-card">
                <div class="dash-label">Pel√≠culas</div>
                <div class="dash-number" id="metric-pelis">-</div>
            </div>
            <div class="dash-card">
                <div class="dash-label">Series</div>
                <div class="dash-number" id="metric-series">-</div>
            </div>
            <div class="dash-card">
                <div class="dash-label">V√≠deos</div>
                <div class="dash-number" id="metric-videos">-</div>
            </div>
            <div class="dash-card">
                <div class="dash-label">Disco Usado</div>
                <div class="dash-number" id="metric-espacio" style="font-size: 3em; color: #fff;">-</div>
                <div class="progress-container">
                    <div class="progress-bar" id="disk-bar"></div>
                </div>
                <div class="disk-info">
                    <span id="disk-used">0 GB</span>
                    <span id="disk-total">Total: 0 GB</span>
                </div>
            </div>
        </div>
        <p style="color:#666; text-align: center;">Bienvenido al panel de control de GargStream.</p>
    </div>

    <div id="sec-cine" class="form-section">
        <h1>Subir Pel√≠cula</h1>
        <p style="color:#aaa; font-size:0.9em;">Escribe el t√≠tulo y sube el archivo. El servidor buscar√° la car√°tula y sinopsis autom√°ticamente.</p>
        <form action="/api/admin/nueva-pelicula" onsubmit="enviarFormulario(event)">
            <label>T√≠tulo:</label>
            <input type="text" name="titulo" required placeholder="Ej: El Padrino">
            <label>Archivo de V√≠deo (Obligatorio):</label>
            <input type="file" name="archivo" required accept="video/*">
            <label>Subt√≠tulos (.srt o .vtt) - Opcional:</label>
            <input type="file" name="subtitulo" accept=".srt,.vtt">
            <button type="submit">Subir Pel√≠cula</button>
        </form>
    </div>

    <div id="sec-serie" class="form-section">
        <h1>Crear Ficha de Serie</h1>
        <form action="/api/admin/nueva-serie" onsubmit="enviarFormulario(event)">
            <label>T√≠tulo de la Serie:</label>
            <input type="text" name="titulo" required placeholder="Ej: Breaking Bad">
            <button type="submit">Crear Ficha</button>
        </form>
    </div>

    <div id="sec-capitulo" class="form-section">
        <h1>Subir Cap√≠tulo</h1>
        <form action="/api/admin/nuevo-capitulo" onsubmit="enviarFormulario(event)">
            <label>Selecciona la Serie:</label>
            <select name="idSerie" id="selector-series" required>
                <option value="" disabled selected>Cargando series...</option>
            </select>
            <div class="row">
                <div style="flex:1">
                    <label>Temporada:</label>
                    <input type="number" name="numTemporada" required value="1">
                </div>
                <div style="flex:1">
                    <label>Cap√≠tulo:</label>
                    <input type="number" name="numCapitulo" required value="1">
                </div>
            </div>
            <label>T√≠tulo del Cap√≠tulo:</label>
            <input type="text" name="titulo" placeholder="Ej: Piloto">
            <label>Archivo de V√≠deo (Obligatorio):</label>
            <input type="file" name="archivo" required accept="video/*">
            <label>Subt√≠tulos (.srt o .vtt) - Opcional:</label>
            <input type="file" name="subtitulo" accept=".srt,.vtt">
            <button type="submit">Subir Cap√≠tulo</button>
        </form>
    </div>

    <div id="sec-video" class="form-section">
        <h1>Subir Video Personal</h1>
        <form action="/api/admin/nuevo-video" onsubmit="enviarFormulario(event)">
            <label>T√≠tulo:</label>
            <input type="text" name="titulo" required>
            <label>Autor:</label>
            <input type="text" name="autor" placeholder="Yo">
            <label>Descripci√≥n:</label>
            <textarea name="descripcion" rows="3"></textarea>
            <label>Archivo de V√≠deo (Obligatorio):</label>
            <input type="file" name="archivo" required accept="video/*">
            <label>Subt√≠tulos (.srt o .vtt) - Opcional:</label>
            <input type="file" name="subtitulo" accept=".srt,.vtt">
            <button type="submit">Subir Video</button>
        </form>
    </div>

    <div id="sec-editar" class="form-section" style="max-width: 900px;">
        <h1>Gestionar Contenido</h1>
        <p style="color:#aaa;">Haz clic en una car√°tula para editar sus datos.</p>
        <div id="grid-edicion" class="grid-content"></div>

        <div id="formulario-edicion" class="edit-form-container">
            <h2 style="margin-top:0; font-family: 'Bebas Neue', sans-serif; letter-spacing: 1px;">Editando: <span id="edit-titulo-display" style="color:#e50914"></span></h2>
            <form action="/api/admin/editar-contenido" onsubmit="enviarFormulario(event)">
                <input type="hidden" name="id" id="edit-id">
                <div class="row">
                    <div style="flex:1">
                        <label>T√≠tulo:</label>
                        <input type="text" name="titulo" id="edit-titulo">
                    </div>
                    <div style="flex:1">
                        <label>ID Youtube Trailer:</label>
                        <input type="text" name="youtubeTrailerId" id="edit-trailer" placeholder="Ej: dQw4w9WgXcQ">
                    </div>
                </div>
                <label>Sinopsis:</label>
                <textarea name="sipnosis" id="edit-sinopsis" rows="4"></textarea>
                <div class="section-separator"></div>
                <div class="section-title">üìÇ Archivos (Opcional)</div>
                <p style="font-size:0.8em; color:#777;">Solo sube archivos si quieres cambiar/a√±adir algo.</p>
                <label>Cambiar Car√°tula:</label>
                <input type="file" name="archivoCaratula" accept="image/*">
                <div class="section-separator"></div>
                <div class="section-title">üåç A√±adir Nuevo Subt√≠tulo</div>
                <div class="row">
                    <div style="flex:1">
                        <label>Idioma (c√≥digo):</label>
                        <select name="idiomaSub">
                            <option value="es">Espa√±ol (es)</option>
                            <option value="en">Ingl√©s (en)</option>
                            <option value="fr">Franc√©s (fr)</option>
                            <option value="de">Alem√°n (de)</option>
                            <option value="it">Italiano (it)</option>
                            <option value="pt">Portugu√©s (pt)</option>
                        </select>
                    </div>
                    <div style="flex:1">
                        <label>Etiqueta (Lo que se ve):</label>
                        <input type="text" name="nombreSub" placeholder="Ej: Espa√±ol, English (CC)">
                    </div>
                </div>
                <label>Archivo Subt√≠tulo (.vtt / .srt):</label>
                <input type="file" name="archivoSubtitulo" accept=".srt,.vtt">
                <button type="submit">üíæ Guardar Cambios</button>
                <button type="button" class="btn-cancelar" onclick="cerrarEditor()">Cancelar</button>
                <button type="button" class="btn-eliminar" onclick="eliminarContenido()">üóëÔ∏è ELIMINAR CONTENIDO</button>
            </form>
        </div>
    </div>

</div>

<div id="overlay-loading">
    <div class="spinner"></div>
    <div class="loading-text">Subiendo contenido...</div>
    <div class="loading-subtext">Por favor, no cierres esta pesta√±a.</div>
</div>

<script src="js/admin.js"></script>
</body>
</html>